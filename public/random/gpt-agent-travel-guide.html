<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>Vietnam (Novâ€“Dec) Â· Field Guide</title>
<meta name="description" content="A one-file, infographic-style guide to Vietnam for November & December: culture, food, climate, top sights, hidden gems, and an 8-week itinerary with a 2-week friend window." />

<style>
/* =========================
   0) MODERN CSS RESET
   ========================= */
*,*::before,*::after{box-sizing:border-box}
html:focus-within{scroll-behavior:smooth}
body,h1,h2,h3,p,ul,ol,li,figure,figcaption,blockquote,dl,dd{margin:0}
ul,ol{padding-left:1.1rem}
img,svg{display:block;max-width:100%}
button{font:inherit}
:root{
  /* Core palette (light by default â€“ improves contrast on mobile) */
  --bg:#f7f8fc;
  --bg-soft:#eef2ff;
  --bg-card:#ffffff;
  --ink:#0e1639;
  --ink-2:#34427a;
  --muted:#4b5a95;
  --line:rgba(18, 30, 78, .15);

  --brand:#0ea5a4;       /* teal */
  --brand-2:#4958f1;     /* periwinkle */
  --accent:#f59e0b;      /* amber */
  --good:#10b981;        /* green */
  --warn:#f59e0b;        /* amber */
  --bad:#ef4444;         /* red */

  --radius:16px; --radius-lg:24px; --radius-sm:12px;
  --shadow: 0 10px 28px rgba(29,40,83,.10), 0 1px 3px rgba(29,40,83,.10);
  --font: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, "Helvetica Neue", Arial, "Noto Sans";
}

/* Optional dark theme */
:root[data-theme="dark"]{
  --bg:#0b1020; --bg-soft:#0e1632; --bg-card:#0f1730;
  --ink:#f3f5ff; --ink-2:#c9d3ff; --muted:#aab4e8;
  --line:rgba(173,189,255,.18);
  --brand:#8ef0d4; --brand-2:#8aa9ff; --accent:#ffd166; --good:#51d88a; --warn:#ffd166; --bad:#ff6b6b;
  --shadow: 0 15px 40px rgba(11,15,40,.35), 0 2px 8px rgba(17,24,39,.5);
}

/* =========================
   1) GLOBAL LAYOUT
   ========================= */
body{
  min-height:100svh; background:
    radial-gradient(1600px 800px at 50% -10%, var(--bg-soft), var(--bg) 55%);
  color:var(--ink); font-family:var(--font); line-height:1.55;
  -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
}
.container{max-width:1200px; margin-inline:auto;
  padding:24px max(16px, env(safe-area-inset-left)) 24px max(16px, env(safe-area-inset-right));
}
p{margin: .5rem 0 1rem}

/* Only visible when focused (fixes the â€œSkip to contentâ€ artifact) */
.skip{
  position:absolute; left:-9999px; top:auto; width:1px; height:1px; overflow:hidden;
}
.skip:focus{
  position:fixed; left:16px; top:10px; width:auto; height:auto; z-index:9999;
  background:var(--bg-card); color:var(--ink); padding:10px 14px; border-radius:999px;
  border:1px solid var(--line); box-shadow:var(--shadow);
}

/* =========================
   2) HEADER
   ========================= */
.header{
  position:sticky; top:0; z-index:20;
  background:linear-gradient(180deg, rgba(255,255,255,.85), rgba(255,255,255,.55));
  border-bottom:1px solid var(--line); backdrop-filter: saturate(1.2) blur(8px);
}
:root[data-theme="dark"] .header{ background:linear-gradient(180deg, rgba(13,17,40,.78), rgba(13,17,40,.42)); }
.nav{display:flex; align-items:center; justify-content:space-between; gap:12px}
.brand{display:flex; align-items:center; gap:10px; color:var(--brand); font-weight:800; letter-spacing:.01em}
.brand .glyph{width:26px; height:26px}
.actions{display:flex; gap:10px; align-items:center}
.btn{
  --pad:10px 14px;
  display:inline-flex; align-items:center; gap:8px; padding:var(--pad);
  border-radius:999px; border:1px solid var(--line); background:var(--bg-card);
  color:var(--ink); cursor:pointer; box-shadow:var(--shadow);
  transition:transform .15s ease, background .15s ease, border-color .15s;
}
.btn.primary{
  background:linear-gradient(135deg,var(--brand-2),var(--brand)); color:#fff; border-color:transparent;
}
.btn:active{transform:translateY(1px)}

/* =========================
   3) HERO + RIBBON
   ========================= */
.hero{padding:28px 0 10px}
.hero .kicker{color:var(--muted); text-transform:uppercase; letter-spacing:.13em; font-weight:700}
.hero h1{font-size:clamp(26px, 4vw + 8px, 46px); margin:.25rem 0 .5rem}
.hero .sub{max-width:72ch; color:var(--ink-2)}

.ribbon{display:flex; flex-wrap:wrap; gap:8px; margin:14px 0 0}
.badge{
  display:inline-flex; align-items:center; gap:8px; padding:10px 12px; font-weight:700;
  border-radius:999px; background:var(--bg-card); border:1px dashed var(--line); color:var(--muted)
}
.badge .glyph{width:18px; height:18px; opacity:.9}

/* =========================
   4) TOOLBAR (filters)
   ========================= */
.tools{
  position:sticky; top:64px; z-index:10; margin-top:12px; padding:12px; border-radius:var(--radius);
  background:var(--bg-card); border:1px solid var(--line); box-shadow:var(--shadow)
}
.tools .row{display:flex; flex-wrap:wrap; gap:10px}
.search{
  flex:1; display:flex; align-items:center; gap:10px; background:var(--bg);
  border:1px solid var(--line); border-radius:999px; padding:10px 14px
}
.search input{all:unset; flex:1; color:var(--ink); font-size:1rem}
.pill{
  padding:10px 14px; border-radius:999px; border:1px solid var(--line); background:var(--bg);
  color:var(--muted); cursor:pointer; font-weight:700
}
.pill[aria-pressed="true"]{background:linear-gradient(135deg,var(--brand-2),var(--brand)); color:#fff; border-color:transparent}

/* =========================
   5) TIMELINE (moved above cards)
   ========================= */
.section h2{display:flex; align-items:center; gap:10px; font-size:clamp(20px, 2.3vw, 28px); margin:10px 0 14px}
.dot{width:10px; height:10px; border-radius:50%; background:linear-gradient(135deg,var(--brand),var(--brand-2)); box-shadow:0 0 0 4px rgba(14,165,164,.18)}
.timeline{overflow:auto; padding:6px 0 12px}
.rail{display:grid; grid-auto-flow:column; grid-auto-columns:minmax(240px,1fr); gap:12px}
.week{
  background:var(--bg-card); border:1px solid var(--line); border-radius:var(--radius); padding:14px; min-height:120px;
  box-shadow:var(--shadow)
}
.week .wk{font-weight:900; color:var(--brand)}
.week .span{font-weight:700; color:var(--muted)}
.week .note{margin-top:.25rem; color:var(--ink-2)}
.week.friend{border-color:rgba(14,165,164,.55); box-shadow:0 0 0 3px rgba(14,165,164,.15) inset}

/* =========================
   6) GRID CARDS
   ========================= */
.grid{display:grid; gap:14px; grid-template-columns:repeat(auto-fill, minmax(300px, 1fr))}
.card{
  display:grid; grid-template-rows:auto auto 1fr auto; gap:6px;
  position:relative; border-radius:var(--radius); padding:16px;
  background:var(--bg-card); border:1px solid var(--line); box-shadow:var(--shadow)
}
.card .head{display:flex; align-items:center; justify-content:space-between; gap:10px}
.title{display:flex; align-items:center; gap:8px}
.title h3{font-size:1.15rem}
.loc{
  position:relative; width:42px; height:74px; border-radius:20px; border:1px solid var(--line);
  background:linear-gradient(180deg, var(--bg-soft), var(--bg));
}
.loc::before{ /* tick marks for N/C/S */
  content:"N  C  S"; position:absolute; inset:auto 0 4px 0; text-align:center; font-size:.62rem; color:var(--muted); letter-spacing:.35em;
}
.loc .dot{position:absolute; left:50%; transform:translate(-50%,-50%); width:10px; height:10px; border-radius:50%;
  background:var(--accent); box-shadow:0 0 0 3px rgba(245,158,11,.25)}
.loc[data-region="North"] .dot{top:18%}
.loc[data-region="Central"] .dot{top:50%}
.loc[data-region="South"] .dot{top:82%}

.meta{display:flex; flex-wrap:wrap; gap:8px; margin:4px 0}
.tag{
  font-size:.78rem; color:var(--muted); border:1px solid var(--line);
  padding:6px 10px; border-radius:999px; background:var(--bg)
}

.climate{display:grid; grid-template-columns:1fr 1fr; gap:8px; margin:4px 0}
.kal{
  border:1px solid var(--line); border-radius:12px; background:var(--bg); padding:8px 10px; color:var(--ink-2)
}
.kal .m{font-weight:900; color:var(--brand)}
.kal .row{display:flex; align-items:center; gap:8px}
.kal .row .glyph{width:16px; height:16px}
.kal.good{box-shadow:0 0 0 2px rgba(16,185,129,.15) inset}
.kal.warn{box-shadow:0 0 0 2px rgba(245,158,11,.18) inset}

ul.list{margin:.35rem 0 0}
ul.list li{margin:.25rem 0; color:var(--ink-2)}

.card .foods,.card .actions{margin-top:10px}
.foods{display:flex; flex-wrap:wrap; gap:6px}
.food{font-size:.78rem; border:1px solid var(--line); background:var(--bg); color:var(--muted); padding:6px 10px; border-radius:999px}

.open{
  margin-top:10px; display:inline-flex; align-items:center; gap:8px; font-weight:800;
  padding:10px 12px; border-radius:999px; border:1px solid var(--line); background:var(--bg);
  color:var(--ink); cursor:pointer;
}
.card[role="button"]{cursor:pointer}
.card[role="button"]:hover{outline:2px solid rgba(73,88,241,.2)}

/* =========================
   7) MODAL
   ========================= */
.modal-back{position:fixed; inset:0; background:rgba(0,0,0,.45); display:none; align-items:flex-end; z-index:50}
.modal{
  width:100%; max-height:88%; background:var(--bg-card); border:1px solid var(--line);
  border-radius:20px 20px 0 0; box-shadow:var(--shadow); overflow:auto;
}
.modal-head{display:flex; align-items:center; justify-content:space-between; padding:16px 16px 8px}
.modal-title{display:flex; align-items:center; gap:10px; font-weight:900}
.modal-body{padding:8px 16px 20px}
.modal .split{display:grid; grid-template-columns:1.1fr .9fr; gap:16px}
.row-kv{display:flex; gap:10px; align-items:flex-start; margin:.25rem 0}
.row-kv b{min-width:110px}

@media (max-width:960px){ .modal .split{grid-template-columns:1fr} }
@media (max-width:760px){ .rail{grid-auto-columns:280px} }

/* =========================
   8) FOOTER
   ========================= */
footer{color:var(--muted); border-top:1px dashed var(--line); margin-top:26px; padding:20px 0 40px}
footer .row{display:flex; gap:10px; flex-wrap:wrap; align-items:center}
</style>
</head>

<body>
<a class="skip" href="#main">Skip to content</a>

<header class="header">
  <div class="container nav" role="navigation" aria-label="top">
    <div class="brand">
      <svg class="glyph" width="26" height="26" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M12 2a10 10 0 1 0 .001 20.001A10 10 0 0 0 12 2zm3.9 7.1l-2.8 6.3a1 1 0 0 1-.5.5l-6.3 2.8a.5.5 0 0 1-.7-.7l2.8-6.3a1 1 0 0 1 .5-.5l6.3-2.8a.5.5 0 0 1 .7.7z"/></svg>
      <strong>Vietnam Â· Novâ€“Dec Â· Field Guide</strong>
    </div>
    <div class="actions">
      <button class="btn" id="themeBtn" aria-pressed="false" title="Toggle theme">ğŸŒ— Theme</button>
      <button class="btn primary" id="printBtn" title="Print or Save as PDF">ğŸ–¨ï¸ Print / PDF</button>
    </div>
  </div>
</header>

<section class="hero container">
  <div class="kicker">Curated â€¢ Workâ€‘friendly â€¢ Playâ€‘forward</div>
  <h1>Vietnam in Late Autumn â€” Culture, Food, Climate & An 8â€‘Week Plan</h1>
  <p class="sub">
    A singleâ€‘file guide to Hue Â· Ha Long Bay Â· Hanoi Â· Ha Giang Loop Â· Hai Van Pass Â· Nha Trang Â· Hoi An Â· Da Nang Â· Phu Quoc Â· Da Lat Â· Ho Chi Minh City Â· Mekong Delta Â· Ba Na Hills Â· My Khe Beach Â· Mui Ne/Phan Thiet.
    Optimized for <b>November & December</b>, with a recommended 2â€‘week window for your friend to join.
  </p>
  <div class="ribbon" role="list">
    <span class="badge" role="listitem">â˜€ï¸ North & South have prime weather</span>
    <span class="badge" role="listitem">ğŸŒ¦ï¸ Central coast easing from rains</span>
    <span class="badge" role="listitem">ğŸ’» Nomad bases: Da Nang Â· HCMC Â· Hanoi</span>
    <span class="badge" role="listitem">ğŸ‘¥ Friend window: Weeks 3â€“4</span>
    <span class="badge" role="listitem">ğŸš† Slowâ€‘travel: rail & coastal drives</span>
  </div>
</section>

<!-- ======= FILTER BAR ======= -->
<section class="container tools" aria-label="Filters">
  <div class="row">
    <div class="search" style="flex:2">
      ğŸ” <input id="q" placeholder="Search places, food, or keywords (e.g., 'lanterns', 'noodles', 'hidden')" autocomplete="off" />
    </div>
    <button class="pill" data-filter="region" data-value="All" aria-pressed="true">All regions</button>
    <button class="pill" data-filter="region" data-value="North" aria-pressed="false">North</button>
    <button class="pill" data-filter="region" data-value="Central" aria-pressed="false">Central</button>
    <button class="pill" data-filter="region" data-value="South" aria-pressed="false">South</button>
    <button class="pill" data-filter="work" data-value="WorkBase" aria-pressed="false">Good work base</button>
    <button class="pill" data-filter="friend" data-value="BestWithFriend" aria-pressed="false">Great with a friend</button>
  </div>
</section>

<!-- ======= TIMELINE (moved up) ======= -->
<section class="container section" id="flow">
  <h2><span class="dot"></span> Suggested 8â€‘Week Flow (friend: weeks 3â€“4)</h2>
  <div class="timeline" aria-label="Itinerary timeline">
    <div class="rail" id="rail"></div>
  </div>
</section>

<main id="main" class="container section">
  <h2><span class="dot"></span> Destinations & Deepâ€‘Cuts</h2>
  <div id="grid" class="grid" role="list"></div>
</main>

<section class="container section" id="practical">
  <h2><span class="dot"></span> Practical Powerâ€‘Ups</h2>
  <div class="grid">
    <div class="card">
      <div class="head"><div class="title"><strong>Weather heuristics (Novâ€“Dec)</strong></div></div>
      <ul class="list">
        <li><b>North (Hanoi, Ha Long)</b> â€” cool & pleasant; crisp light. Light layers.</li>
        <li><b>Central (Hue â†’ Da Nang â†’ Hoi An â†’ Nha Trang)</b> â€” showers taper; keep a compact poncho.</li>
        <li><b>South (HCMC, Mekong, Phu Quoc)</b> â€” dry season; warm, low rain. SPF 50.</li>
      </ul>
    </div>
    <div class="card">
      <div class="head"><div class="title"><strong>Workâ€‘friendly bases</strong></div></div>
      <ul class="list">
        <li><b>Da Nang (An Thuong)</b> â€” beach + cafÃ©s + fiber.</li>
        <li><b>HCMC (District 1/3 & Thao Dien)</b> â€” coâ€‘works & food miles.</li>
        <li><b>Hanoi (Tay Ho)</b> â€” lakeside, quieter, good coffee.</li>
      </ul>
    </div>
    <div class="card">
      <div class="head"><div class="title"><strong>Transit rhythm</strong></div></div>
      <ul class="list">
        <li>Prefer rail & scenic roads (Hai Van Pass). </li>
        <li>Use short flights for Northâ†”South hops.</li>
        <li>Night trains double as lodging.</li>
      </ul>
    </div>
  </div>
</section>

<footer class="container">
  <div class="row">
    <span>Built for clarity, comfort, and a bit of play. </span>
    <button class="btn" id="backTop">â¬†ï¸ Back to top</button>
  </div>
</footer>

<!-- =========================
     JS: Data + Rendering
     ========================= -->
<script>
/* ---------- Data (tuned text: less em-dashes/semicolons) ---------- */
const PLACES = [
  { id:'hue', name:'Hue', region:'Central',
    climate:{Nov:'19â€“24Â°C Â· frequent rain', Dec:'18â€“22Â°C Â· easing rain'},
    culture:'Former imperial capital on the Perfume River. Nguyen dynasty citadels and refined royal cuisine.',
    food:['Bun bo Hue (spicy beef noodle)','Com hen (clam rice)','Banh beo (steamed rice discs)'],
    attractions:['Imperial City & Citadel','Thien Mu Pagoda','Royal Tombs (Khai Dinh, Minh Mang)'],
    hidden:['Vong Canh Hill sunset ridge','Tam Giang lagoon sampan trip'],
    tips:['Buy combined tomb tickets','Carry a compact poncho'],
    flags:{WorkBase:false, BestWithFriend:true}
  },
  { id:'halong', name:'Ha Long Bay', region:'North',
    climate:{Nov:'~22Â°C Â· dry & clear', Dec:'15â€“21Â°C Â· dry Â· misty mornings'},
    culture:'UNESCO marine karst of limestone towers and caves. Some floating villages remain.',
    food:['Cha muc (grilled squid cake)','Sea snail hotpot'],
    attractions:['Overnight bay cruise','Sung Sot Cave','Kayak Luon Cave'],
    hidden:['Lan Ha or Bai Tu Long (quieter bays)','Cat Ba island cycle loops'],
    tips:['Choose smaller boats for calmer coves','Pack a light layer for fog'],
    flags:{WorkBase:false, BestWithFriend:true}
  },
  { id:'hanoi', name:'Hanoi', region:'North',
    climate:{Nov:'20â€“26Â°C Â· crisp', Dec:'15â€“22Â°C Â· cool'},
    culture:'Old Quarter alleys, lakes, French villas, slow coffee culture.',
    food:['Pho bo','Bun cha','Egg coffee'],
    attractions:['Hoan Kiem Lake & Old Quarter','Temple of Literature','Train Street (timed)'],
    hidden:['Long Bien sunrise walk','Corner bia hoi at dusk'],
    tips:['Stay near Hoan Kiem for walkability','Cash helps at street stalls'],
    flags:{WorkBase:true, BestWithFriend:true}
  },
  { id:'hagiang', name:'Ha Giang Loop', region:'North',
    climate:{Nov:'10â€“20Â°C Â· clear & cool', Dec:'6â€“16Â°C Â· cold Â· mist pockets'},
    culture:'Canyon roads and ethnic markets within the Dong Van Karst Geopark.',
    food:['Thang co (mountain stew)','Corn wine'],
    attractions:['Ma Pi Leng Pass ridge ride','Lung Cu Flag Tower','Dong Van Sunday Market'],
    hidden:['Nho Que River boat into Tu San canyon','Homestay weaving demos'],
    tips:['Use an â€œEasyâ€‘Riderâ€ if you donâ€™t ride','Bring warm layers and gloves'],
    flags:{WorkBase:false, BestWithFriend:true}
  },
  { id:'haivan', name:'Hai Van Pass', region:'Central',
    climate:{Nov:'22â€“27Â°C Â· possible mist', Dec:'20â€“24Â°C Â· clearer windows'},
    culture:'Ocean Cloud Pass. Coastal ridge between Hue and Da Nang; famous scenic road.',
    food:['Lang Co seafood shacks','Bun cha ca (fishâ€‘cake noodles)'],
    attractions:['Motorcycle or jeep traverse','Hai Van Gate fort','Lang Co lagoon view'],
    hidden:['Rail lookouts at Don Ca bridge','Lonely Pine viewpoint'],
    tips:['Late morning often clearer at the summit','Hire a jeep if carrying big packs'],
    flags:{WorkBase:false, BestWithFriend:true}
  },
  { id:'nhatrang', name:'Nha Trang', region:'Central',
    climate:{Nov:'23â€“28Â°C Â· rainy breaks', Dec:'22â€“27Â°C Â· improving'},
    culture:'Beach city with Cham heritage and reefs. Easy islandâ€‘hop days.',
    food:['Bun cha ca (jellyfish optional)','Grilled lobster (market)'],
    attractions:['Po Nagar Cham Towers','Snorkel Hon Mun','Thap Ba hot springs'],
    hidden:['Vinh Luong fishing port at dawn','Doc Let beach day'],
    tips:['Choose boats on calmer eastâ€‘wind days','Keep a poncho handy'],
    flags:{WorkBase:false, BestWithFriend:true}
  },
  { id:'hoian', name:'Hoi An', region:'Central',
    climate:{Nov:'22â€“27Â°C Â· showers', Dec:'19â€“24Â°C Â· cooler Â· festive'},
    culture:'UNESCO trading town. Lantern nights, historic halls, and tailoring.',
    food:['Cao lau','White rose dumplings','Mi Quang'],
    attractions:['Ancient Town (lantern nights)','Japanese Bridge','An Bang beach (clear days)'],
    hidden:['Cam Kim cycle to woodcarvers','Tra Que herb village cooking'],
    tips:['Lantern nights are pedestrianâ€‘only','Avoid highâ€‘tide blocks during heavy rain'],
    flags:{WorkBase:true, BestWithFriend:true}
  },
  { id:'danang', name:'Da Nang', region:'Central',
    climate:{Nov:'22â€“27Â°C Â· showers easing', Dec:'20â€“25Â°C Â· mild'},
    culture:'Modern beach city with bridges and cafÃ©s. Great base for work.',
    food:['Mi Quang','Banh xeo with herbs'],
    attractions:['Marble Mountains','Dragon Bridge show (weekends)','Son Tra peninsula'],
    hidden:['Nam O rockâ€‘reef sunrise','An Thuong workâ€‘cafÃ© cluster'],
    tips:['Base here for Hoi An & Ba Na trips','eSIM + fiber makes work easy'],
    flags:{WorkBase:true, BestWithFriend:true}
  },
  { id:'phuquoc', name:'Phu Quoc', region:'South',
    climate:{Nov:'27â€“31Â°C Â· dry starts', Dec:'23â€“31Â°C Â· dry & sunny'},
    culture:'Pearl Island with whiteâ€‘sand beaches, night markets, and island snorkel runs.',
    food:['Herring salad','Fish sauce tastings','Sea urchin porridge'],
    attractions:['Sao & Khem beaches','Hon Thom cable car isles','Duong Dong Night Market'],
    hidden:['Rach Vem starfish flats (calm days)','Ham Ninh fishing village dawn'],
    tips:['Calm seas Decâ€“Mar for snorkeling','Ride scooters cautiously on slick new roads'],
    flags:{WorkBase:false, BestWithFriend:true}
  },
  { id:'dalat', name:'Da Lat', region:'Central',
    climate:{Nov:'14â€“24Â°C Â· dry & crisp', Dec:'13â€“21Â°C Â· chilliest month'},
    culture:'Highland city of pines, lakes, villas, and specialty coffee.',
    food:['Artichoke tea','Banh canh xiu mai','Avocado ice cream'],
    attractions:['Xuan Huong Lake loop','Crazy House (Hang Nga)','Langbiang peak trek'],
    hidden:['Hydrangea farm photo spots','Tuyen Lam SUP at dawn'],
    tips:['Pack a fleece for nights','Great place to write and cafÃ©â€‘hop'],
    flags:{WorkBase:true, BestWithFriend:true}
  },
  { id:'hcmc', name:'Ho Chi Minh City (Saigon)', region:'South',
    climate:{Nov:'24â€“31Â°C Â· dry begins', Dec:'22â€“31Â°C Â· dry & sunny'},
    culture:'Highâ€‘energy city for history, food crawls, rooftops, and coâ€‘working.',
    food:['Banh mi','Com tam','Hu tieu Nam Vang'],
    attractions:['War Remnants Museum','Reunification Palace','Ben Thanh Market'],
    hidden:['Thao Dien craft cafÃ©s (D2)','Chinatown pagodas and eats'],
    tips:['Rooftop sunset then a streetâ€‘food crawl','Grab is cheap; helmets are a must'],
    flags:{WorkBase:true, BestWithFriend:true}
  },
  { id:'mekong', name:'Mekong Delta', region:'South',
    climate:{Nov:'26â€“31Â°C Â· drier', Dec:'24â€“31Â°C Â· bright'},
    culture:'River life with floating markets, coconut and fruit isles, and homestays.',
    food:['Hu tieu boat noodles','Coconut candy'],
    attractions:['Cai Rang floating market','Ben Tre canals','Vinh Long homestay'],
    hidden:['Tra Su cajuput forest','Mo Cay coconut â€œfactory alleysâ€'],
    tips:['Start markets 5â€“6am','DIY loop: My Tho â†’ Ben Tre â†’ Can Tho'],
    flags:{WorkBase:false, BestWithFriend:true}
  },
  { id:'bana', name:'Ba Na Hills & Golden Bridge', region:'Central',
    climate:{Nov:'20â€“24Â°C Â· sun/mist mix', Dec:'18â€“22Â°C Â· cooler'},
    culture:'Hill resort via record cable car. Hands Bridge and gardens at altitude.',
    food:['Hill cafÃ©s','Danang specialties in town below'],
    attractions:['Golden Bridge stroll','Long cable car ride','Le Jardin gardens'],
    hidden:['Quiet arboretum paths','Mountain tea corners in fog'],
    tips:['Go early; clouds lift quickly','Layer upâ€”temps drop at 1,400 m+'],
    flags:{WorkBase:false, BestWithFriend:true}
  },
  { id:'mykhe', name:'My Khe Beach (Da Nang)', region:'Central',
    climate:{Nov:'23â€“27Â°C Â· surfable', Dec:'22â€“25Â°C Â· calmer days'},
    culture:'Long city beach for sunrise runs, coffee dips, and surf lessons.',
    food:['Seafood BBQ roadside','Banh mi á»‘p la breakfast'],
    attractions:['Sunrise swim + coffee','Beach path cycle','SUP on flat mornings'],
    hidden:['Lady Buddha viewpoints','Quiet Marble caves'],
    tips:['Check rip/tide boards','Best light before 8am'],
    flags:{WorkBase:true, BestWithFriend:true}
  },
  { id:'muine', name:'Mui Ne / Phan Thiet', region:'South',
    climate:{Nov:'24â€“30Â°C Â· dry winds', Dec:'23â€“30Â°C Â· dry & sunny'},
    culture:'Sandâ€‘dune and kitesurf zone with a laidâ€‘back strip.',
    food:['Seafood hotpot','Banh quai vac'],
    attractions:['Red & White dunes','Fairy Stream','Fishing harbor sunset'],
    hidden:['Ke Ga lighthouse day trip','Cham sites near Phan Thiet'],
    tips:['Sun + wind: SPF, hat, lip balm','Prime kite season Novâ€“Mar'],
    flags:{WorkBase:false, BestWithFriend:true}
  }
];

/* ---------- Itinerary data ---------- */
const WEEKS = [
  {wk:1, span:'Days 1â€“7',  focus:'Hanoi â†’ Ha Long Bay', note:'Old Quarter base; overnight bay cruise; preview southbound rail.'},
  {wk:2, span:'Days 8â€“14', focus:'Hue â†’ Hai Van Pass â†’ Da Nang', note:'Citadel + tombs; jeep/moto pass; settle in An Thuong for work.'},
  {wk:3, span:'Days 15â€“21', focus:'Hoi An (Friend joins)', note:'Lantern night, tailoring, herbâ€‘village ride; An Bang beach windows.'},
  {wk:4, span:'Days 22â€“28', focus:'Ba Na Hills â†’ My Khe â†’ Nha Trang', note:'Hands Bridge early; sunrise swims; spa day; sleeper south.'},
  {wk:5, span:'Days 29â€“35', focus:'Da Lat highlands', note:'Coffee roastery hop, lake loop, Langbiang trek; cool nights.'},
  {wk:6, span:'Days 36â€“42', focus:'Ho Chi Minh City', note:'History loop + food crawl; rooftops; coâ€‘work; Cu Chi day trip.'},
  {wk:7, span:'Days 43â€“49', focus:'Mekong Delta', note:'Ben Tre canals â†’ Can Tho markets; homestay; DIY loop.'},
  {wk:8, span:'Days 50â€“56', focus:'Phu Quoc cooldown', note:'Sao/Khem beaches; snorkel isles; night market finale; fly out.'}
];

/* ---------- Render functions ---------- */
const grid = document.getElementById('grid');
const q = document.getElementById('q');
const pillBtns = document.querySelectorAll('.pill');
const rail = document.getElementById('rail');
const themeBtn = document.getElementById('themeBtn');

let state = { query:'', region:'All', filterWork:false, filterFriend:false };

function kal(p, month){
  const txt = p.climate[month] || '';
  const cls = /dry|clear|sun|mild/i.test(txt) ? 'good' : /rain|mist|cold/i.test(txt) ? 'warn' : '';
  return `
    <div class="kal ${cls}" aria-label="${p.name} ${month} climate">
      <div class="m">${month}</div>
      <div class="row"><svg class="glyph" viewBox="0 0 24 24"><path fill="currentColor" d="M7 17a4 4 0 1 1 1-7.874A5.5 5.5 0 1 1 13 20H7zM16 4l1.2 1.6L19 6l-1.3 1 .5 1.8L16 8l-1.6.8.5-1.8L13.5 6l1.7-.4z"/></svg> <span>${txt}</span></div>
    </div>`;
}

function card(p){
  return `
  <article class="card" role="button" tabindex="0" data-id="${p.id}" aria-label="Open ${p.name} details">
    <div class="head">
      <div class="title">
        <svg width="18" height="18" viewBox="0 0 24 24" style="color:var(--accent)"><path fill="currentColor" d="M12 2a7 7 0 0 0-7 7c0 5.25 7 13 7 13s7-7.75 7-13a7 7 0 0 0-7-7zm0 9.5a2.5 2.5 0 1 1 0-5 2.5 2.5 0 0 1 0 5z"/></svg>
        <h3>${p.name}</h3>
      </div>
      <div class="loc" data-region="${p.region}"><span class="dot"></span></div>
    </div>

    <div class="meta">
      <span class="tag">${p.region}</span>
      ${p.flags.WorkBase ? '<span class="tag">ğŸ’» Workâ€‘base</span>' : ''}
      ${p.flags.BestWithFriend ? '<span class="tag">ğŸ‘¥ Friendâ€‘fun</span>' : ''}
    </div>

    <div class="climate">${kal(p,'Nov')}${kal(p,'Dec')}</div>

    <p>${p.culture}</p>
    <ul class="list">
      ${p.attractions.slice(0,3).map(x=>`<li>${x}</li>`).join('')}
    </ul>

    <div class="foods">${p.food.slice(0,3).map(x=>`<span class="food">${x}</span>`).join('')}</div>
    <button class="open" aria-hidden="true">View details â–¸</button>
  </article>`;
}

function render(){
  const rows = PLACES.filter(p=>{
    if(state.region!=='All' && p.region!==state.region) return false;
    if(state.filterWork && !p.flags.WorkBase) return false;
    if(state.filterFriend && !p.flags.BestWithFriend) return false;
    if(state.query){
      const t = (p.name + ' ' + p.culture + ' ' + p.food.join(' ') + ' ' + p.attractions.join(' ') + ' ' + (p.hidden||[]).join(' ') + ' ' + p.region).toLowerCase();
      if(!t.includes(state.query.toLowerCase())) return false;
    }
    return true;
  }).map(card).join('');
  grid.innerHTML = rows || `<div class="card"><h3>No matches</h3><p>Try different filters or keywords.</p></div>`;

  document.querySelectorAll('.card').forEach(el=>{
    el.addEventListener('click', ()=>openModal(el.dataset.id));
    el.addEventListener('keypress', e=>{ if(e.key==='Enter') openModal(el.dataset.id); });
  });
}

function renderRail(){
  rail.innerHTML = WEEKS.map(w=>{
    const cls = (w.wk===3 || w.wk===4) ? 'week friend' : 'week';
    return `<div class="${cls}">
      <div class="wk">Week ${w.wk}</div>
      <div class="span">${w.span}</div>
      <div class="note"><b>${w.focus}</b><br/>${w.note}</div>
    </div>`;
  }).join('');
}

/* ---------- Filters ---------- */
q.addEventListener('input', e => { state.query = e.target.value; render(); });
pillBtns.forEach(btn=>{
  btn.addEventListener('click', ()=>{
    const type = btn.dataset.filter, val = btn.dataset.value;
    if(type==='region'){
      pillBtns.forEach(b=>{ if(b.dataset.filter==='region') b.setAttribute('aria-pressed','false'); });
      state.region = val; btn.setAttribute('aria-pressed','true');
    } else if(type==='work'){
      state.filterWork = btn.getAttribute('aria-pressed')!=='true';
      btn.setAttribute('aria-pressed', String(state.filterWork));
    } else if(type==='friend'){
      state.filterFriend = btn.getAttribute('aria-pressed')!=='true';
      btn.setAttribute('aria-pressed', String(state.filterFriend));
    }
    render();
  });
});

/* ---------- Modal ---------- */
const modalBack = document.createElement('div');
modalBack.className = 'modal-back';
modalBack.innerHTML = `
  <div class="modal" role="dialog" aria-modal="true" aria-label="Destination details">
    <div class="modal-head">
      <div class="modal-title" id="modalTitle"></div>
      <button class="btn" id="closeModal">Close</button>
    </div>
    <div class="modal-body">
      <div class="split">
        <div id="leftCol"></div>
        <div id="rightCol"></div>
      </div>
    </div>
  </div>`;
document.body.appendChild(modalBack);

function openModal(id){
  const p = PLACES.find(x=>x.id===id); if(!p) return;

  document.getElementById('modalTitle').innerHTML = `
    <svg width="18" height="18" viewBox="0 0 24 24" style="color:var(--accent)"><path fill="currentColor" d="M12 2a7 7 0 0 0-7 7c0 5.25 7 13 7 13s7-7.75 7-13a7 7 0 0 0-7-7zm0 9.5a2.5 2.5 0 1 1 0-5 2.5 2.5 0 0 1 0 5z"/></svg>
    <strong>${p.name}</strong> <span class="tag" style="margin-left:8px">${p.region}</span>`;

  const left = `
    <div class="row-kv"><b>Culture</b><div>${p.culture}</div></div>
    <div class="row-kv"><b>Climate</b>
      <div class="climate">${kal(p,'Nov')}${kal(p,'Dec')}</div>
    </div>
    <div class="row-kv"><b>Top Sights</b>
      <div><ul class="list">${p.attractions.map(x=>`<li>${x}</li>`).join('')}</ul></div>
    </div>
  `;
  const right = `
    <div class="row-kv"><b>Locator</b>
      <div class="loc" data-region="${p.region}" style="margin-top:4px"><span class="dot"></span></div>
    </div>
    <div class="row-kv"><b>Hidden Gems</b>
      <div><ul class="list">${(p.hidden||[]).map(x=>`<li>${x}</li>`).join('') || '<li>â€”</li>'}</ul></div>
    </div>
    <div class="row-kv"><b>Eat This</b><div class="foods">${p.food.map(x=>`<span class="food">${x}</span>`).join('')}</div></div>
    <div class="row-kv"><b>Tips</b><div><ul class="list">${p.tips.map(x=>`<li>${x}</li>`).join('')}</ul></div></div>
  `;

  document.getElementById('leftCol').innerHTML = left;
  document.getElementById('rightCol').innerHTML = right;

  modalBack.style.display='flex';
  document.getElementById('closeModal').focus();
}
modalBack.addEventListener('click', e=>{ if(e.target===modalBack || e.target.id==='closeModal') modalBack.style.display='none'; });
document.addEventListener('keydown', e=>{ if(e.key==='Escape') modalBack.style.display='none'; });

/* ---------- Utilities ---------- */
document.getElementById('printBtn').addEventListener('click', ()=>window.print());
document.getElementById('backTop').addEventListener('click', ()=> window.scrollTo({top:0, behavior:'smooth'}));

/* Theme toggle (persists) */
(function initTheme(){
  const saved = localStorage.getItem('theme');
  if(saved==='dark' || (saved===null && window.matchMedia('(prefers-color-scheme: dark)').matches)){
    document.documentElement.setAttribute('data-theme','dark'); themeBtn.setAttribute('aria-pressed','true');
  }
})();
themeBtn.addEventListener('click', ()=>{
  const isDark = document.documentElement.getAttribute('data-theme')==='dark';
  document.documentElement.setAttribute('data-theme', isDark ? 'light' : 'dark');
  localStorage.setItem('theme', isDark ? 'light' : 'dark');
  themeBtn.setAttribute('aria-pressed', String(!isDark));
});

/* ---------- Init ---------- */
renderRail();
render();
</script>
</body>
</html>
